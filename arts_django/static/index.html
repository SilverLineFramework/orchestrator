<!DOCTYPE html>
<html>
	<head>
		<meta charset=utf-8 />
		<meta name="viewport" content="user-scalable=no, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, minimal-ui">
		<title>CONIX Vizualization Demo</title>
        <link href="style.css" rel="stylesheet" />
        <!-- d3 -->
        <script src="https://d3js.org/d3.v4.min.js"></script>
		<!-- paho mqtt -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.2/mqttws31.min.js" type="text/javascript"></script>
        <!-- lodash (json .isEqual) -->
        <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.10/lodash.min.js"></script>
    </head>
 
	<body>
        <div id="panel" class="panel"></div>
		<div id="config" class="config">
			<div class="preamble">
				<span class="label label-info">CONIX Vizualization Demo</span>
				<p/>
					<button class="button" onclick="loadTreeData()">Refresh</button><p/>
            </div>
			<div id="create_mod_div" class="preamble">
                <p>Create Module:</p>
                <select id="file_select" onchange="onFileSelectChange('file_select')">
                    <option value='{ "name": "test", "filename": "test.zip", "fileid":"1mcJhBvnNqs1CpNsZG2QUjhk3_8SS7Q7U", "filetype": "PY"}'>test (python)</option>
                    <option value='{ "name": "hello", "filename": "hello.zip", "fileid":"19IU7-03XnKYVuyNuz4xCZkSPQ4pFZsDw", "filetype": "PY"}'>hello (python)</option>
                    <option value='{ "name": "helloworld", "filename": "helloworld.wasm", "fileid":"na", "filetype": "WA"}'>hello (wasm)</option>
                </select><p/>
                <table>
                <tr><td>Name:</td><td><input type="text" size=40 id="mname" value=""></td></tr>
                <tr><td>Filename:</td><td><input type="text" size=40 id="filename" value=""></td></tr>
                <tr><td>Fileid:</td><td><input type="text" size=40 id="fileid" value=""></td></tr>
                <tr><td>Filetype:</td><td><input type="text" size=40 id="filetype" value=""></td></tr>
                <tr><td>Args:</td><td><input type="text" size=40 id="args" value=""></td></tr>
                <tr><td>Runtime:</td><td><select id="runtime_select"></select></td></tr>
                </table>
                <button onclick="createModule()">Create</button>
            </div>    
			<div id="stdout_div" class="preamble">
                <p id="module_label">Module Stdout</p>
                <textarea id="stdout-box" rows="10" cols="50"></textarea>
            </div>
			<div class="status">
				<p style="display:inline">Server: </p>
				<input type="text" size=27 id="mqtt_server" value="oz.andrew.cmu.edu">:
				<input type="text" size=4 id="mqtt_port" value="9001">
				<button onclick="reConnect()">Connect</button>
				<p/>
				<textarea id="status-box" rows="10" cols="50"></textarea>
			</div>
							
			<!-- demo src-->
            <script src="script.js"></script>
            
            <script>
                onFileSelectChange('file_select');
                function onFileSelectChange(sid) {
                  var v = JSON.parse(document.getElementById(sid).value);
                  console.log(v)
                  document.getElementById("mname").value = v.name;
                  document.getElementById("filename").value = v.filename;
                  document.getElementById("fileid").value = v.fileid;
                  document.getElementById("filetype").value = v.filetype;
                }
            </script>   
                        
		</div>
    </body>
    
</html>
